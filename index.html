<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rumah Data Kependudukan ‚Äì Kalurahan Kedungsari</title>
  <meta name="description" content="Rumah Data Kependudukan Kalurahan Kedungsari ‚Äì Pusat informasi data kependudukan, demografi, dan layanan administrasi warga secara transparan dan terbuka."/>
  <meta name="keywords" content="Rumah Data, Kependudukan, Kalurahan Kedungsari, Data Demografi, Administrasi Desa, Yogyakarta, Open Data"/>
  <meta name="author" content="Kalurahan Kedungsari"/>
  <meta name="robots" content="index, follow"/>
  <meta name="geo.region" content="ID-YO"/>
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="Rumah Data Kependudukan ‚Äì Kalurahan Kedungsari"/>
  <meta property="og:description" content="Pusat informasi data kependudukan Kalurahan Kedungsari secara transparan dan terbuka."/>
  <meta property="og:locale" content="id_ID"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <link rel="canonical" href="https://kalurahan-kedungsari.github.io/"/>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"GovernmentOrganization","name":"Rumah Data Kependudukan Kalurahan Kedungsari","url":"https://kalurahan-kedungsari.github.io/","address":{"@type":"PostalAddress","addressLocality":"Kedungsari","addressRegion":"Yogyakarta","addressCountry":"ID"}}</script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet"/>
<style>
:root{
  --cream:#F5EFE0;--parchment:#EDE3CC;--brown:#3D2B1F;--brown-mid:#6B4C35;
  --brown-lite:#A07850;--green:#2D5016;--green-mid:#4A7C28;--green-lite:#7FB347;
  --gold:#C8922A;--gold-lite:#E8B84B;--red:#8B2020;--teal:#1A5F6A;
  --white:#FDFAF4;--shadow:rgba(61,43,31,.18);
  --r-sm:6px;--r-md:12px;--r-lg:20px;--tr:all .28s cubic-bezier(.4,0,.2,1);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'DM Sans',sans-serif;background:var(--cream);color:var(--brown);overflow-x:hidden;min-height:100vh}
body::before{content:'';position:fixed;inset:0;background-image:radial-gradient(circle at 15% 15%,rgba(200,146,42,.08) 0%,transparent 55%),radial-gradient(circle at 85% 80%,rgba(45,80,22,.07) 0%,transparent 55%),url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23C8922A' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/svg%3E");pointer-events:none;z-index:0}

/* HEADER */
header{position:relative;z-index:10;background:linear-gradient(135deg,var(--green) 0%,#1e3a0e 60%,var(--brown) 100%);overflow:hidden}
header::after{content:'';position:absolute;inset:0;background:url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M40 0 L80 40 L40 80 L0 40 Z' fill='rgba(255,255,255,0.03)'/%3E%3C/svg%3E") repeat;pointer-events:none}
/* FIXED bukan absolute - agar tidak dipotong overflow:hidden dari header */
#adminTrigger{position:fixed;top:0;right:0;width:80px;height:80px;z-index:500;background:transparent;border:none;outline:none;cursor:default;-webkit-tap-highlight-color:transparent;user-select:none;touch-action:manipulation}
.header-inner{position:relative;z-index:2;max-width:1200px;margin:0 auto;padding:32px 24px 40px;display:flex;flex-direction:column;align-items:center;text-align:center;gap:16px}
.header-badge{display:inline-flex;align-items:center;gap:8px;background:rgba(200,146,42,.25);border:1px solid rgba(200,146,42,.5);border-radius:100px;padding:6px 16px;font-family:'DM Mono',monospace;font-size:.72rem;color:var(--gold-lite);letter-spacing:.1em;text-transform:uppercase;animation:fadeDown .6s ease both}
.header-logo{font-size:3.2rem;animation:fadeDown .5s .1s ease both}
.header-title{font-family:'Playfair Display',serif;font-weight:900;font-size:clamp(1.9rem,5vw,3.4rem);color:var(--white);line-height:1.12;animation:fadeDown .5s .2s ease both}
.header-title span{color:var(--gold-lite);display:block}
.header-subtitle{font-size:.95rem;color:rgba(253,250,244,.72);max-width:520px;line-height:1.65;animation:fadeDown .5s .3s ease both}
.header-stats-bar{display:flex;gap:24px;flex-wrap:wrap;justify-content:center;margin-top:8px;animation:fadeDown .5s .4s ease both}
.stat-chip{background:rgba(255,255,255,.1);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.15);border-radius:var(--r-md);padding:10px 18px;text-align:center}
.stat-chip .num{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:700;color:var(--gold-lite);display:block}
.stat-chip .label{font-size:.72rem;color:rgba(253,250,244,.7);text-transform:uppercase;letter-spacing:.08em}

/* HERO IMAGE */
.hero-image{width:100%;max-width:1200px;margin:0 auto;position:relative;overflow:hidden;border-radius:0 0 var(--r-lg) var(--r-lg)}
.hero-image img{width:100%;height:auto;display:block;object-fit:cover;max-height:400px}

/* TICKER */
.ticker-bar{position:relative;z-index:10;background:var(--gold);padding:7px 0;overflow:hidden}
.ticker-content{display:flex;gap:64px;white-space:nowrap;animation:tickerScroll 28s linear infinite;font-family:'DM Mono',monospace;font-size:.75rem;color:var(--brown);font-weight:500;padding:0 24px}
@keyframes tickerScroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}

/* MAIN */
main{position:relative;z-index:1;max-width:1280px;margin:0 auto;padding:40px 20px 60px}
.section-header{display:flex;align-items:baseline;gap:14px;margin-bottom:28px}
.section-title{font-family:'Playfair Display',serif;font-size:clamp(1.25rem,3vw,1.6rem);font-weight:700;color:var(--brown)}
.section-line{flex:1;height:2px;background:linear-gradient(to right,var(--brown-lite),transparent);border-radius:2px}
.section-tag{font-family:'DM Mono',monospace;font-size:.68rem;color:var(--brown-lite);text-transform:uppercase;letter-spacing:.12em}

/* DASHBOARD */
.dashboard-row{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px;margin-bottom:64px}
.dash-card{background:var(--white);border-radius:var(--r-md);padding:22px 20px;border:1px solid rgba(61,43,31,.08);box-shadow:0 2px 8px var(--shadow);transition:var(--tr);position:relative;overflow:hidden}
.dash-card::after{content:attr(data-emoji);position:absolute;right:12px;bottom:8px;font-size:2.8rem;opacity:.12;pointer-events:none}
.dash-card:hover{transform:translateY(-2px);box-shadow:0 8px 24px var(--shadow)}
.dash-card .dc-label{font-size:.72rem;text-transform:uppercase;letter-spacing:.1em;color:var(--brown-lite);margin-bottom:6px}
.dash-card .dc-value{font-family:'Playfair Display',serif;font-size:2rem;font-weight:700;color:var(--brown);line-height:1}
.dash-card .dc-sub{font-size:.74rem;color:var(--brown-lite);margin-top:4px}
.dc-green{border-left:3px solid var(--green-mid)}.dc-gold{border-left:3px solid var(--gold)}.dc-red{border-left:3px solid var(--red)}.dc-teal{border-left:3px solid var(--teal)}

/* PHOTO WALL */
.photo-wall{columns:4 240px;gap:16px;margin-bottom:64px}
.photo-frame{break-inside:avoid;margin-bottom:16px;background:var(--white);border-radius:var(--r-md);overflow:hidden;box-shadow:0 2px 12px var(--shadow);cursor:pointer;transition:var(--tr);position:relative}
.photo-frame:hover{transform:translateY(-4px) scale(1.015);box-shadow:0 12px 32px var(--shadow),0 0 0 1px rgba(200,146,42,.25)}
.photo-frame:hover .frame-overlay{opacity:1}
.photo-frame img{width:100%;height:auto;display:block;object-fit:cover}
.emoji-frame{aspect-ratio:4/3;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;background:linear-gradient(135deg,var(--parchment),var(--cream));border:2px dashed rgba(160,120,80,.35)}
.emoji-frame .big-emoji{font-size:2.8rem;line-height:1}
.emoji-frame .frame-caption{font-size:.78rem;color:var(--brown-lite);text-align:center;padding:0 12px;font-style:italic}
.frame-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(61,43,31,.82),transparent 55%);opacity:0;transition:var(--tr);display:flex;align-items:flex-end;padding:14px}
.frame-label{padding:10px 12px 12px;border-top:1px solid rgba(61,43,31,.06)}
.frame-label strong{display:block;font-size:.82rem;font-weight:600;color:var(--brown);margin-bottom:2px}
.frame-label span{font-size:.72rem;color:var(--brown-lite)}
.frame-tall .emoji-frame{aspect-ratio:3/4}

/* VIDEO BUTTON IN CARD */
.card-video-btn{position:absolute;top:10px;right:10px;background:rgba(26,95,106,.95);backdrop-filter:blur(8px);color:var(--white);border:none;padding:8px 14px;border-radius:100px;font-family:'DM Sans',sans-serif;font-size:.75rem;font-weight:600;cursor:pointer;transition:var(--tr);box-shadow:0 2px 8px rgba(0,0,0,.3);z-index:5;display:flex;align-items:center;gap:6px}
.card-video-btn:hover{background:var(--teal);transform:scale(1.05);box-shadow:0 4px 12px rgba(0,0,0,.4)}
.card-video-btn:active{transform:scale(0.98)}

/* REPORTS */
.reports-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px;margin-bottom:64px}
.report-card{background:var(--white);border-radius:var(--r-md);border:1px solid rgba(61,43,31,.09);padding:20px;display:flex;flex-direction:column;gap:12px;box-shadow:0 2px 8px var(--shadow);transition:var(--tr);position:relative;overflow:hidden}
.report-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--green),var(--gold));transform:scaleX(0);transform-origin:left;transition:transform .3s ease}
.report-card:hover::before{transform:scaleX(1)}
.report-card:hover{transform:translateY(-3px);box-shadow:0 10px 28px var(--shadow)}
.report-card .img-container{position:relative}
.report-card img{width:100%;height:auto;border-radius:var(--r-sm);margin-bottom:8px;object-fit:cover;max-height:180px}
.report-icon{font-size:1.9rem}
.report-card h3{font-family:'Playfair Display',serif;font-size:1.05rem;color:var(--brown);font-weight:700}
.report-card p{font-size:.82rem;color:var(--brown-lite);line-height:1.6;flex:1}
.report-meta{display:flex;justify-content:space-between;align-items:center;padding-top:12px;border-top:1px solid rgba(61,43,31,.07)}
.report-date{font-family:'DM Mono',monospace;font-size:.7rem;color:var(--brown-lite)}
.report-btn{font-size:.74rem;font-weight:600;color:var(--green);background:rgba(45,80,22,.08);border:none;padding:5px 12px;border-radius:100px;cursor:pointer;transition:var(--tr)}
.report-btn:hover{background:var(--green);color:var(--white)}

/* KEGIATAN */
.kegiatan-strip{display:flex;gap:16px;overflow-x:auto;padding-bottom:12px;margin-bottom:64px;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch}
.kegiatan-strip::-webkit-scrollbar{height:5px}.kegiatan-strip::-webkit-scrollbar-track{background:rgba(61,43,31,.07);border-radius:4px}.kegiatan-strip::-webkit-scrollbar-thumb{background:var(--brown-lite);border-radius:4px}
.kegiatan-card{flex:0 0 260px;scroll-snap-align:start;background:var(--white);border-radius:var(--r-md);overflow:hidden;box-shadow:0 2px 10px var(--shadow);transition:var(--tr);position:relative}
.kegiatan-card:hover{transform:translateY(-3px) scale(1.015);box-shadow:0 10px 28px var(--shadow)}
.kegiatan-card .img-container{position:relative}
.kegiatan-card img{width:100%;height:160px;object-fit:cover;display:block}
.kegiatan-img{height:160px;background:linear-gradient(135deg,var(--parchment),var(--cream));display:flex;align-items:center;justify-content:center;font-size:3rem;border-bottom:2px dashed rgba(160,120,80,.3)}
.kegiatan-info{padding:14px}
.kegiatan-info h4{font-weight:600;font-size:.88rem;color:var(--brown);margin-bottom:4px}
.kegiatan-info span{font-size:.74rem;color:var(--brown-lite)}

/* LIGHTBOX */
.lightbox{display:none;position:fixed;inset:0;z-index:9999;background:rgba(20,12,5,.9);backdrop-filter:blur(10px);align-items:center;justify-content:center;padding:24px}
.lightbox.active{display:flex}
.lightbox-inner{max-width:900px;max-height:90vh;width:100%;position:relative;animation:lbIn .25s ease}
@keyframes lbIn{from{transform:scale(.88);opacity:0}to{transform:scale(1);opacity:1}}
.lightbox-content{width:100%;background:var(--white);border-radius:var(--r-md);overflow:hidden}
.lightbox-content img{width:100%;height:auto;display:block;max-height:70vh;object-fit:contain}
.lightbox-emoji-big{width:100%;min-height:280px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:5rem;gap:16px;background:rgba(245,239,224,.05);border-radius:var(--r-md)}
.lightbox-emoji-big p{font-size:1rem;color:rgba(253,250,244,.8);text-align:center;max-width:360px}
.lightbox-caption{padding:20px;background:var(--white);color:var(--brown)}
.lightbox-caption strong{display:block;font-size:1.1rem;margin-bottom:8px}
.lightbox-close{position:absolute;top:-14px;right:-14px;width:40px;height:40px;background:var(--gold);color:var(--brown);border:none;border-radius:50%;font-size:1.1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;font-weight:700;transition:var(--tr);box-shadow:0 4px 12px rgba(0,0,0,.35)}
.lightbox-close:hover{background:var(--gold-lite);transform:rotate(90deg)}

/* FOOTER */
footer{position:relative;z-index:10;background:linear-gradient(160deg,var(--brown) 0%,#1c110a 100%);color:rgba(253,250,244,.75);overflow:hidden}
footer::before{content:'';position:absolute;inset:0;background:url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M40 0 L80 40 L40 80 L0 40 Z' fill='rgba(200,146,42,0.05)'/%3E%3C/svg%3E") repeat;pointer-events:none}
.footer-inner{position:relative;max-width:1200px;margin:0 auto;padding:48px 24px 0}
.footer-top{display:grid;grid-template-columns:1.5fr 1fr 1fr;gap:40px;margin-bottom:40px}
.footer-brand h2{font-family:'Playfair Display',serif;font-size:1.25rem;color:var(--white);margin-bottom:10px}
.footer-brand p{font-size:.82rem;line-height:1.7;color:rgba(253,250,244,.6);max-width:300px}
.footer-col h4{font-size:.8rem;text-transform:uppercase;letter-spacing:.12em;color:var(--gold-lite);margin-bottom:14px;font-weight:600}
.footer-col ul{list-style:none;display:flex;flex-direction:column;gap:8px}
.footer-col ul li a{color:rgba(253,250,244,.6);text-decoration:none;font-size:.82rem;transition:var(--tr);display:inline-flex;align-items:center;gap:6px}
.footer-col ul li a:hover{color:var(--gold-lite);transform:translateX(3px)}
.quick-access{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:var(--r-lg);padding:28px;margin-bottom:28px}
.qa-title{font-size:.78rem;text-transform:uppercase;letter-spacing:.12em;color:var(--gold-lite);margin-bottom:18px;font-weight:600}
.qa-buttons{display:flex;flex-wrap:wrap;gap:10px}
.qa-btn{display:inline-flex;align-items:center;gap:8px;padding:10px 18px;border-radius:100px;border:none;font-family:'DM Sans',sans-serif;font-size:.82rem;font-weight:600;cursor:pointer;text-decoration:none;transition:var(--tr)}
.qa-btn.primary{background:var(--gold);color:var(--brown)}.qa-btn.primary:hover{background:var(--gold-lite);transform:translateY(-2px)}
.qa-btn.secondary{background:rgba(255,255,255,.08);color:var(--white);border:1px solid rgba(255,255,255,.14)}.qa-btn.secondary:hover{background:rgba(255,255,255,.15);transform:translateY(-2px)}
.qa-btn.green{background:rgba(45,80,22,.7);color:var(--green-lite);border:1px solid rgba(127,179,71,.25)}.qa-btn.green:hover{background:var(--green-mid);color:var(--white);transform:translateY(-2px)}
.qa-btn.teal{background:rgba(26,95,106,.6);color:#7dd3dc;border:1px solid rgba(26,95,106,.8)}.qa-btn.teal:hover{background:var(--teal);color:var(--white);transform:translateY(-2px)}
.footer-bottom{border-top:1px solid rgba(255,255,255,.08);padding:18px 0;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px}
.footer-bottom p{font-size:.75rem;color:rgba(253,250,244,.4)}
.footer-bottom p span{color:var(--gold-lite)}
.footer-badge{display:inline-flex;align-items:center;gap:6px;font-family:'DM Mono',monospace;font-size:.68rem;color:rgba(253,250,244,.35);border:1px solid rgba(255,255,255,.1);padding:4px 10px;border-radius:100px}

/* BACK TO TOP */
#backToTop{position:fixed;bottom:28px;right:24px;width:46px;height:46px;background:var(--green);color:var(--white);border:none;border-radius:50%;font-size:1.1rem;cursor:pointer;box-shadow:0 4px 16px rgba(0,0,0,.28);display:flex;align-items:center;justify-content:center;opacity:0;transform:translateY(10px);transition:var(--tr);z-index:999}
#backToTop.show{opacity:1;transform:translateY(0)}
#backToTop:hover{background:var(--green-mid)}

@keyframes fadeDown{from{transform:translateY(-14px);opacity:0}to{transform:translateY(0);opacity:1}}
.fade-in{animation:fadeUp .6s ease both}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN PANEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#pinModal{display:none;position:fixed;inset:0;z-index:99999;background:rgba(20,12,5,.93);backdrop-filter:blur(12px);align-items:center;justify-content:center;padding:16px}
#pinModal.active{display:flex}
.pin-box{background:var(--white);border-radius:var(--r-lg);padding:32px 28px;width:min(340px,100%);text-align:center;box-shadow:0 32px 80px rgba(0,0,0,.5);animation:lbIn .25s ease}
.pin-box h2{font-family:'Playfair Display',serif;font-size:1.35rem;color:var(--brown);margin-bottom:6px}
.pin-box p{font-size:.82rem;color:var(--brown-lite);margin-bottom:22px}
.pin-dots{display:flex;justify-content:center;gap:14px;margin-bottom:22px}
.pin-dot{width:14px;height:14px;border-radius:50%;background:rgba(61,43,31,.15);transition:var(--tr)}
.pin-dot.filled{background:var(--green)}
.pin-pad{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:12px}
.pin-key{background:var(--parchment);border:1px solid rgba(61,43,31,.12);border-radius:var(--r-md);padding:15px;font-family:'Playfair Display',serif;font-size:1.3rem;font-weight:700;color:var(--brown);cursor:pointer;transition:var(--tr);-webkit-tap-highlight-color:transparent;touch-action:manipulation}
.pin-key:hover,.pin-key:active{background:var(--gold);color:var(--white)}
.pin-key.del{font-size:1rem;font-family:'DM Sans',sans-serif}
.pin-error{font-size:.8rem;color:#c0392b;min-height:20px;margin-bottom:4px}
.pin-close-btn{background:none;border:none;font-size:.8rem;color:var(--brown-lite);cursor:pointer;text-decoration:underline}

/* Admin Panel Drawer */
#adminPanel{position:fixed;top:0;right:0;width:min(480px,100vw);height:100vh;height:100dvh;background:#271a10;z-index:88888;transform:translateX(100%);transition:transform .38s cubic-bezier(.4,0,.2,1);box-shadow:-8px 0 40px rgba(0,0,0,.5);display:flex;flex-direction:column;overflow:hidden}
#adminPanel.open{transform:translateX(0)}
.ap-header{background:linear-gradient(135deg,var(--green),#1a3309);padding:13px 16px;display:flex;align-items:center;gap:10px;flex-shrink:0}
.ap-header h2{font-family:'Playfair Display',serif;color:var(--white);font-size:.92rem;flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ap-hbtns{display:flex;gap:8px;flex-shrink:0}
.ap-close{background:rgba(255,255,255,.12);border:none;color:var(--white);width:36px;height:36px;border-radius:50%;cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;touch-action:manipulation;transition:var(--tr)}
.ap-close:hover{background:rgba(255,255,255,.28)}
.ap-logout-btn{background:rgba(139,32,32,.45);border:1px solid rgba(139,32,32,.6);color:#ffb3b3;font-size:.72rem;padding:6px 12px;border-radius:100px;cursor:pointer;font-family:'DM Sans',sans-serif;touch-action:manipulation;transition:var(--tr);white-space:nowrap}
.ap-logout-btn:hover{background:var(--red);color:#fff}
.ap-tabs{display:flex;background:rgba(0,0,0,.3);flex-shrink:0;overflow-x:auto}
.ap-tabs::-webkit-scrollbar{display:none}
.ap-tab{flex:1;min-width:66px;padding:10px 4px;background:none;border:none;color:rgba(253,250,244,.45);font-family:'DM Sans',sans-serif;font-size:.72rem;font-weight:600;cursor:pointer;border-bottom:2px solid transparent;white-space:nowrap;touch-action:manipulation;transition:var(--tr)}
.ap-tab.active{color:var(--gold-lite);border-bottom-color:var(--gold-lite);background:rgba(200,146,42,.1)}

/* KEY: ap-body must scroll independently */
.ap-body{flex:1 1 0;min-height:0;overflow-y:auto;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}
.ap-body::-webkit-scrollbar{width:4px}
.ap-body::-webkit-scrollbar-track{background:rgba(0,0,0,.15)}
.ap-body::-webkit-scrollbar-thumb{background:rgba(200,146,42,.5);border-radius:2px}
.ap-panel{display:none;padding:20px 16px}
.ap-panel.active{display:block}
.ap-form{background:rgba(255,255,255,.04);border-radius:var(--r-md);padding:18px;margin-bottom:16px;display:none}
.ap-form.active{display:block}
.ap-form-title{font-size:.95rem;font-weight:600;color:var(--gold-lite);margin-bottom:14px}
.ap-field{margin-bottom:14px}
.ap-field label{display:block;font-size:.75rem;color:rgba(253,250,244,.7);margin-bottom:5px;text-transform:uppercase;letter-spacing:.08em}
.ap-field input,.ap-field textarea{width:100%;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:var(--r-sm);padding:10px 12px;font-family:'DM Sans',sans-serif;font-size:.85rem;color:var(--white)}
.ap-field input::placeholder,.ap-field textarea::placeholder{color:rgba(253,250,244,.3)}
.ap-field textarea{resize:vertical;min-height:80px}
.ap-btns{display:flex;gap:10px;margin-top:16px}
.ap-btn{flex:1;padding:10px 16px;border:none;border-radius:var(--r-sm);font-family:'DM Sans',sans-serif;font-size:.82rem;font-weight:600;cursor:pointer;transition:var(--tr);touch-action:manipulation}
.ap-btn.save{background:var(--green);color:var(--white)}
.ap-btn.save:hover{background:var(--green-mid)}
.ap-btn.cancel{background:rgba(255,255,255,.08);color:rgba(253,250,244,.7)}
.ap-btn.cancel:hover{background:rgba(255,255,255,.15)}
.ap-add-btn{width:100%;background:rgba(45,80,22,.3);border:1px dashed rgba(127,179,71,.4);color:var(--green-lite);padding:12px;border-radius:var(--r-md);font-family:'DM Sans',sans-serif;font-size:.85rem;font-weight:600;cursor:pointer;margin-bottom:16px;transition:var(--tr);touch-action:manipulation}
.ap-add-btn:hover{background:rgba(45,80,22,.5);border-color:var(--green-lite)}
.ap-list-item{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:var(--r-md);padding:12px 14px;margin-bottom:10px;display:flex;gap:12px;align-items:center}
.ap-list-body{flex:1;min-width:0}
.ap-list-body strong{display:block;font-size:.85rem;color:var(--white);margin-bottom:2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ap-list-body span{font-size:.72rem;color:rgba(253,250,244,.5);display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ap-list-actions{display:flex;gap:6px;flex-shrink:0}
.ap-edit,.ap-del{background:rgba(255,255,255,.08);border:none;color:rgba(253,250,244,.7);padding:6px 10px;border-radius:var(--r-sm);font-size:.7rem;cursor:pointer;font-family:'DM Sans',sans-serif;transition:var(--tr);touch-action:manipulation}
.ap-edit:hover{background:var(--gold);color:var(--brown)}
.ap-del:hover{background:var(--red);color:var(--white)}
#adminBadge{position:fixed;top:10px;left:50%;transform:translateX(-50%) scale(0);background:var(--gold);color:var(--brown);padding:6px 16px;border-radius:100px;font-family:'DM Mono',monospace;font-size:.7rem;font-weight:600;letter-spacing:.08em;z-index:99998;box-shadow:0 4px 12px rgba(0,0,0,.3);transition:transform .25s ease;pointer-events:none}
#adminBadge.visible{transform:translateX(-50%) scale(1)}
#toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--brown);color:var(--white);padding:12px 24px;border-radius:100px;font-size:.82rem;box-shadow:0 6px 20px rgba(0,0,0,.4);z-index:99999;opacity:0;transition:all .3s ease;pointer-events:none}
#toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

@media(max-width:768px){
  .footer-top{grid-template-columns:1fr;gap:28px}
  .dashboard-row{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}
  .photo-wall{columns:2 180px}
  .reports-grid{grid-template-columns:1fr}
  .kegiatan-card{flex:0 0 220px}
}
</style>
</head>
<body>
<button id="adminTrigger" aria-label="Admin trigger"></button>

<header>
  <div class="header-inner">
    <div class="header-badge">üáÆüá© Open Government Data</div>
    <div class="header-logo">üèõÔ∏è</div>
    <h1 class="header-title">Rumah Data Kependudukan<br><span>Kalurahan Kedungsari</span></h1>
    <p class="header-subtitle">Pusat informasi data kependudukan, demografi, dan layanan administrasi warga yang transparan, akurat, dan mudah diakses</p>
    <div class="header-stats-bar" id="headerStats"></div>
  </div>
  <!-- Hero Image -->
  <div class="hero-image" id="heroImage"></div>
</header>

<div class="ticker-bar">
  <div class="ticker-content" id="tickerContent"></div>
</div>

<main>
  <section class="fade-in">
    <div class="section-header"><h2 class="section-title">üìä Dashboard Data Kependudukan</h2><div class="section-line"></div><span class="section-tag">Real-time</span></div>
    <div class="dashboard-row" id="dashboardData"></div>
  </section>

  <section id="foto" class="fade-in">
    <div class="section-header"><h2 class="section-title">üñºÔ∏è Dinding & Foto</h2><div class="section-line"></div><span class="section-tag">Galeri</span></div>
    <div class="photo-wall" id="photoWall"></div>
  </section>

  <section id="laporan" class="fade-in">
    <div class="section-header"><h2 class="section-title">üìã Laporan & Dokumen</h2><div class="section-line"></div><span class="section-tag">Unduh</span></div>
    <div class="reports-grid" id="reportsGrid"></div>
  </section>

  <section id="kegiatan" class="fade-in">
    <div class="section-header"><h2 class="section-title">üéâ Kegiatan Kalurahan</h2><div class="section-line"></div><span class="section-tag">Terbaru</span></div>
    <div class="kegiatan-strip" id="kegiatanStrip"></div>
  </section>
</main>

<footer id="kontak">
  <div class="footer-inner">
    <div class="quick-access">
      <div class="qa-title">‚ö° Akses Cepat &amp; Layanan</div>
      <div class="qa-buttons">
        <a href="#laporan" class="qa-btn primary">üìä Laporan Data</a>
        <a href="#foto" class="qa-btn secondary">üñºÔ∏è Galeri Foto</a>
        <a href="#kegiatan" class="qa-btn secondary">üéâ Kegiatan</a>
        <a href="https://dukcapil.jogjaprov.go.id/" target="_blank" rel="noopener" class="qa-btn green">ü™™ Adminduk Online</a>
        <a href="https://sid.kemendesa.go.id/" target="_blank" rel="noopener" class="qa-btn green">üóÇÔ∏è SID Kemendes</a>
        <a href="https://wa.me/628123456789" target="_blank" rel="noopener" class="qa-btn teal">üí¨ WhatsApp Desa</a>
        <a href="/cdn-cgi/l/email-protection#1970777f7659727c7d6c777e6a786b70377d7c6a7837707d" class="qa-btn teal">‚úâÔ∏è Surel Kalurahan</a>
      </div>
    </div>
    <div class="footer-top">
      <div class="footer-brand">
        <h2>üèõÔ∏è Rumah Data Kependudukan<br>Kalurahan Kedungsari</h2>
        <p>Kami berkomitmen menyajikan data kependudukan yang akurat, transparan, dan mudah diakses demi terwujudnya pemerintahan desa yang bersih dan melayani.</p>
      </div>
      <div class="footer-col">
        <h4>Navigasi</h4>
        <ul>
          <li><a href="#">üè† Beranda</a></li>
          <li><a href="#foto">üñºÔ∏è Galeri Foto</a></li>
          <li><a href="#laporan">üìã Laporan</a></li>
          <li><a href="#kegiatan">üéâ Kegiatan</a></li>
          <li><a href="#kontak">üìç Kontak</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Info Kontak</h4>
        <ul>
          <li><a href="#">üìç Jl. Raya Kedungsari No.1, Yogyakarta</a></li>
          <li><a href="tel:+6274123456">üìû (0274) 123-4567</a></li>
          <li><a href="/cdn-cgi/l/email-protection#4c25222a230c27292839222b3f2d3e256228293f2d622528">‚úâÔ∏è <span class="__cf_email__" data-cfemail="3f565159507f545a5b4a51584c5e4d56115b5a4c5e11565b">[email&#160;protected]</span></a></li>
          <li><a href="#">üïê Senin‚ÄìKamis, 08.00‚Äì14.00</a></li>
          <li><a href="#">üåê kalurahan-kedungsari.github.io</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>¬© 2025 Kalurahan Kedungsari ¬∑ Dibuat dengan ‚ù§Ô∏è untuk <span>transparansi data</span> desa</p>
      <div class="footer-badge">üáÆüá© &nbsp; Open Data &nbsp;¬∑&nbsp; v2.2</div>
    </div>
  </div>
</footer>

<button id="backToTop" aria-label="Kembali ke atas">‚Üë</button>

<div class="lightbox" id="lightbox" onclick="closeLB(event)">
  <div class="lightbox-inner">
    <button class="lightbox-close" onclick="closeLB()">‚úï</button>
    <div class="lightbox-content" id="lbContent"></div>
    <div class="lightbox-caption" id="lbCaption"></div>
  </div>
</div>

<div id="adminBadge">‚öôÔ∏è Mode Admin Aktif</div>
<div id="toast"></div>

<div id="pinModal" role="dialog" aria-modal="true">
  <div class="pin-box">
    <h2>üîê Admin Panel</h2>
    <p>Masukkan PIN 4 digit untuk masuk</p>
    <div class="pin-dots">
      <div class="pin-dot" id="pd0"></div><div class="pin-dot" id="pd1"></div>
      <div class="pin-dot" id="pd2"></div><div class="pin-dot" id="pd3"></div>
    </div>
    <div class="pin-pad">
      <button class="pin-key" onclick="pk('1')">1</button>
      <button class="pin-key" onclick="pk('2')">2</button>
      <button class="pin-key" onclick="pk('3')">3</button>
      <button class="pin-key" onclick="pk('4')">4</button>
      <button class="pin-key" onclick="pk('5')">5</button>
      <button class="pin-key" onclick="pk('6')">6</button>
      <button class="pin-key" onclick="pk('7')">7</button>
      <button class="pin-key" onclick="pk('8')">8</button>
      <button class="pin-key" onclick="pk('9')">9</button>
      <button class="pin-key del" onclick="pk('clr')">Hapus</button>
      <button class="pin-key" onclick="pk('0')">0</button>
      <button class="pin-key del" onclick="pk('back')">‚Üê</button>
    </div>
    <div class="pin-error" id="pinErr"></div>
    <button class="pin-close-btn" onclick="closePIN()">Batal</button>
  </div>
</div>

<div id="adminPanel">
  <div class="ap-header">
    <h2>‚öôÔ∏è Panel Admin</h2>
    <div class="ap-hbtns">
      <button class="ap-logout-btn" onclick="adminLogout()">Keluar</button>
      <button class="ap-close" onclick="closeAdmin()">‚úï</button>
    </div>
  </div>
  <div class="ap-tabs">
    <button class="ap-tab active" onclick="swTab('stat',this)">Statistik</button>
    <button class="ap-tab" onclick="swTab('foto',this)">Foto</button>
    <button class="ap-tab" onclick="swTab('lap',this)">Laporan</button>
    <button class="ap-tab" onclick="swTab('keg',this)">Kegiatan</button>
  </div>
  <div class="ap-body">
    <!-- STATISTIK -->
    <div class="ap-panel active" id="tab-stat">
      <div class="ap-form-title">Edit Data Statistik</div>
      <div class="ap-field"><label>Penduduk</label><input id="f_p" placeholder="12345"/></div>
      <div class="ap-field"><label>Kepala Keluarga</label><input id="f_kk" placeholder="3456"/></div>
      <div class="ap-field"><label>Dusun</label><input id="f_ds" placeholder="6"/></div>
      <div class="ap-field"><label>Tahun</label><input id="f_thn" placeholder="2025"/></div>
      <div class="ap-field"><label>Dash 1 Nilai</label><input id="f_d1" placeholder="5678"/></div>
      <div class="ap-field"><label>Dash 1 Sub</label><input id="f_d1s" placeholder="Laki-laki"/></div>
      <div class="ap-field"><label>Dash 2 Nilai</label><input id="f_d2" placeholder="6789"/></div>
      <div class="ap-field"><label>Dash 2 Sub</label><input id="f_d2s" placeholder="Perempuan"/></div>
      <div class="ap-field"><label>Dash 3 Nilai</label><input id="f_d3" placeholder="98%"/></div>
      <div class="ap-field"><label>Dash 3 Sub</label><input id="f_d3s" placeholder="Melek huruf"/></div>
      <div class="ap-field"><label>Dash 4 Nilai</label><input id="f_d4" placeholder="4567"/></div>
      <div class="ap-field"><label>Dash 4 Sub</label><input id="f_d4s" placeholder="Usia produktif"/></div>
      <div class="ap-field"><label>Dash 5 Nilai</label><input id="f_d5" placeholder="234"/></div>
      <div class="ap-field"><label>Dash 5 Sub</label><input id="f_d5s" placeholder="Lansia"/></div>
      <div class="ap-field"><label>Dash 6 Nilai</label><input id="f_d6" placeholder="1234"/></div>
      <div class="ap-field"><label>Dash 6 Sub</label><input id="f_d6s" placeholder="Balita"/></div>
      <div class="ap-field"><label>Ticker 1</label><input id="f_tk1" placeholder="Selamat datang"/></div>
      <div class="ap-field"><label>Ticker 2</label><input id="f_tk2" placeholder="Data terbaru"/></div>
      <div class="ap-field"><label>Ticker 3</label><input id="f_tk3" placeholder="Informasi"/></div>
      <div class="ap-field"><label>Ticker 4</label><input id="f_tk4" placeholder="Layanan 24/7"/></div>
      <div class="ap-field"><label>Ticker 5</label><input id="f_tk5" placeholder="Transparan"/></div>
      <div class="ap-field"><label>Ticker 6</label><input id="f_tk6" placeholder="Akurat"/></div>
      <button class="ap-btn save" onclick="saveStat()">üíæ Simpan Statistik</button>
    </div>

    <!-- FOTO -->
    <div class="ap-panel" id="tab-foto">
      <div class="ap-form-title">Manajemen Foto & Video</div>
      <button class="ap-add-btn" onclick="addFoto()">‚ûï Tambah Foto/Video</button>
      <div class="ap-form" id="fotoForm">
        <div class="ap-form-title" id="fotoLbl">Tambah Foto</div>
        <input type="hidden" id="fotoIdx" value="-1"/>
        <div class="ap-field"><label>Emoji/Icon</label><input id="fotoE" placeholder="üèûÔ∏è" maxlength="2"/></div>
        <div class="ap-field"><label>Judul</label><input id="fotoJ" placeholder="Nama lokasi"/></div>
        <div class="ap-field"><label>Keterangan</label><input id="fotoD" placeholder="Deskripsi"/></div>
        <div class="ap-field"><label>Nama File Foto (dari GitHub)</label><input id="fotoImg" placeholder="contoh: balai-desa.jpg"/></div>
        <div class="ap-field"><label>Link Video (opsional)</label><input id="fotoVid" placeholder="https://youtube.com/..."/></div>
        <div class="ap-btns">
          <button class="ap-btn save" onclick="saveFoto()">üíæ Simpan</button>
          <button class="ap-btn cancel" onclick="cancelFoto()">Batal</button>
        </div>
      </div>
      <div id="fotoList"></div>
    </div>

    <!-- LAPORAN -->
    <div class="ap-panel" id="tab-lap">
      <div class="ap-form-title">Manajemen Laporan & Video</div>
      <button class="ap-add-btn" onclick="addL()">‚ûï Tambah Laporan/Video</button>
      <div class="ap-form" id="lForm">
        <div class="ap-form-title" id="lLbl">Tambah Laporan</div>
        <input type="hidden" id="lIdx" value="-1"/>
        <div class="ap-field"><label>Emoji</label><input id="lE" placeholder="üìÑ" maxlength="2"/></div>
        <div class="ap-field"><label>Judul</label><input id="lJ" placeholder="Nama laporan"/></div>
        <div class="ap-field"><label>Deskripsi</label><textarea id="lD" placeholder="Penjelasan singkat"></textarea></div>
        <div class="ap-field"><label>Tanggal</label><input id="lT" placeholder="01 Jan 2025"/></div>
        <div class="ap-field"><label>Label Tombol</label><input id="lB" placeholder="Unduh PDF"/></div>
        <div class="ap-field"><label>Link/URL</label><input id="lU" placeholder="https://..."/></div>
        <div class="ap-field"><label>Nama File Foto (dari GitHub)</label><input id="lImg" placeholder="contoh: laporan-01.jpg"/></div>
        <div class="ap-field"><label>Link Video (opsional)</label><input id="lVid" placeholder="https://youtube.com/..."/></div>
        <div class="ap-btns">
          <button class="ap-btn save" onclick="saveL()">üíæ Simpan</button>
          <button class="ap-btn cancel" onclick="cancelL()">Batal</button>
        </div>
      </div>
      <div id="lList"></div>
    </div>

    <!-- KEGIATAN -->
    <div class="ap-panel" id="tab-keg">
      <div class="ap-form-title">Manajemen Kegiatan & Video</div>
      <button class="ap-add-btn" onclick="addK()">‚ûï Tambah Kegiatan/Video</button>
      <div class="ap-form" id="kForm">
        <div class="ap-form-title" id="kLbl">Tambah Kegiatan</div>
        <input type="hidden" id="kIdx" value="-1"/>
        <div class="ap-field"><label>Emoji</label><input id="kE" placeholder="üéâ" maxlength="2"/></div>
        <div class="ap-field"><label>Nama Kegiatan</label><input id="kJ" placeholder="Gotong royong"/></div>
        <div class="ap-field"><label>Tanggal</label><input id="kT" placeholder="15 Feb 2025"/></div>
        <div class="ap-field"><label>Nama File Foto (dari GitHub)</label><input id="kImg" placeholder="contoh: kegiatan-01.jpg"/></div>
        <div class="ap-field"><label>Link Video (opsional)</label><input id="kVid" placeholder="https://youtube.com/..."/></div>
        <div class="ap-btns">
          <button class="ap-btn save" onclick="saveK()">üíæ Simpan</button>
          <button class="ap-btn cancel" onclick="cancelK()">Batal</button>
        </div>
      </div>
      <div id="kList"></div>
    </div>
  </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
// Base URL untuk GitHub repo
const GITHUB_BASE = 'https://raw.githubusercontent.com/KDMP-Kedungsari/rumah-data/main/assets/images/';

const g=id=>document.getElementById(id);
const esc=s=>(s||'').replace(/</g,'&lt;').replace(/>/g,'&gt;');
function showToast(msg){const t=g('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500);}
function scrollToForm(fid){setTimeout(()=>{const f=g(fid);if(f)f.scrollIntoView({behavior:'smooth',block:'start'});},100);}

const DEF={
  s:{p:'12345',kk:'3456',ds:'6',thn:'2025',
     d1:'5678',d1s:'Laki-laki',d2:'6789',d2s:'Perempuan',d3:'98%',d3s:'Melek huruf',
     d4:'4567',d4s:'Usia produktif',d5:'234',d5s:'Lansia',d6:'1234',d6s:'Balita',
     tk1:'üåü Selamat datang di Rumah Data Kependudukan Kalurahan Kedungsari',
     tk2:'üìä Data selalu diperbarui secara berkala',
     tk3:'üîí Privasi dan keamanan data terjamin',
     tk4:'üíº Layanan administrasi kependudukan tersedia',
     tk5:'üåê Akses informasi kapan saja, di mana saja',
     tk6:'‚ú® Transparansi adalah komitmen kami'},
  foto:[
    {e:'üèõÔ∏è',j:'Balai Kalurahan',d:'Kantor pusat pemerintahan',img:'balai-desa.jpg',vid:'https://www.youtube.com/watch?v=dQw4w9WgXcQ'},
    {e:'üè´',j:'Sekolah Dasar',d:'Fasilitas pendidikan utama',img:'',vid:'https://www.youtube.com/watch?v=dQw4w9WgXcQ'},
    {e:'üè•',j:'Puskesmas',d:'Layanan kesehatan masyarakat',img:'',vid:''}
  ],
  l:[
    {e:'üìä',j:'Laporan Kependudukan 2025',d:'Data lengkap statistik penduduk tahun 2025',t:'01 Jan 2025',b:'Unduh PDF',u:'#',img:'',vid:'https://www.youtube.com/watch?v=dQw4w9WgXcQ'},
    {e:'üí∞',j:'APBDes 2025',d:'Anggaran Pendapatan dan Belanja Desa',t:'15 Des 2024',b:'Lihat Detail',u:'#',img:'',vid:''}
  ],
  k:[
    {e:'üéâ',j:'Gotong Royong Bersih Desa',t:'15 Feb 2025',img:'',vid:'https://www.youtube.com/watch?v=dQw4w9WgXcQ'},
    {e:'üåæ',j:'Panen Raya',t:'10 Feb 2025',img:'',vid:''}
  ]
};

let D=JSON.parse(localStorage.getItem('rumahData')||'null')||JSON.parse(JSON.stringify(DEF));
function store(d){localStorage.setItem('rumahData',JSON.stringify(d));}

// Pastikan data tersedia saat pertama kali load
if(!localStorage.getItem('rumahData')){
  console.log('Initializing default data...');
  D=JSON.parse(JSON.stringify(DEF));
  store(D);
}

/* RENDER */
function renderAll(){
  console.log('Rendering all sections...',D);
  renderStat();
  renderFoto();
  renderLaporan();
  renderKegiatan();
  renderHero();
}
function renderStat(){
  const s=D.s;
  g('headerStats').innerHTML=`
    <div class="stat-chip"><span class="num">${esc(s.p)}</span><span class="label">Penduduk</span></div>
    <div class="stat-chip"><span class="num">${esc(s.kk)}</span><span class="label">Kepala Keluarga</span></div>
    <div class="stat-chip"><span class="num">${esc(s.ds)}</span><span class="label">Dusun</span></div>
    <div class="stat-chip"><span class="num">${esc(s.thn)}</span><span class="label">Data Tahun</span></div>
  `;
  g('dashboardData').innerHTML=`
    <div class="dash-card dc-green" data-emoji="üë®"><div class="dc-label">Laki-Laki</div><div class="dc-value">${esc(s.d1)}</div><div class="dc-sub">${esc(s.d1s)}</div></div>
    <div class="dash-card dc-gold" data-emoji="üë©"><div class="dc-label">Perempuan</div><div class="dc-value">${esc(s.d2)}</div><div class="dc-sub">${esc(s.d2s)}</div></div>
    <div class="dash-card dc-teal" data-emoji="üìñ"><div class="dc-label">Literasi</div><div class="dc-value">${esc(s.d3)}</div><div class="dc-sub">${esc(s.d3s)}</div></div>
    <div class="dash-card dc-green" data-emoji="üíº"><div class="dc-label">Produktif</div><div class="dc-value">${esc(s.d4)}</div><div class="dc-sub">${esc(s.d4s)}</div></div>
    <div class="dash-card dc-gold" data-emoji="üë¥"><div class="dc-label">Lansia</div><div class="dc-value">${esc(s.d5)}</div><div class="dc-sub">${esc(s.d5s)}</div></div>
    <div class="dash-card dc-teal" data-emoji="üë∂"><div class="dc-label">Balita</div><div class="dc-value">${esc(s.d6)}</div><div class="dc-sub">${esc(s.d6s)}</div></div>
  `;
  const tk=[s.tk1,s.tk2,s.tk3,s.tk4,s.tk5,s.tk6].filter(x=>x);
  g('tickerContent').innerHTML=(tk.join(' &nbsp;‚Ä¢&nbsp; ')+' &nbsp;‚Ä¢&nbsp; ').repeat(3);
}

function renderFoto(){
  const c=g('photoWall');
  if(!c)return;
  c.innerHTML=D.foto.map((f,i)=>{
    const videoBtn=f.vid?`<button class="card-video-btn" onclick="event.stopPropagation();window.open('${esc(f.vid)}','_blank')">‚ñ∂Ô∏è Video</button>`:'';
    if(f.img){
      const imgUrl=GITHUB_BASE+f.img;
      return `<div class="photo-frame" onclick="openPhotoLB(${i})">
        ${videoBtn}
        <img src="${imgUrl}" alt="${esc(f.j)}"/>
        <div class="frame-label"><strong>${esc(f.j)}</strong><span>${esc(f.d)}</span></div>
      </div>`;
    }else{
      return `<div class="photo-frame" onclick="openFotoLB('${f.e}','${esc(f.j)}','${esc(f.d)}')">
        ${videoBtn}
        <div class="emoji-frame"><span class="big-emoji">${f.e}</span><span class="frame-caption">${esc(f.d)}</span></div>
        <div class="frame-label"><strong>${esc(f.j)}</strong><span>${esc(f.d)}</span></div>
      </div>`;
    }
  }).join('');
}

function renderLaporan(){
  const c=g('reportsGrid');
  if(!c)return;
  c.innerHTML=D.l.map((l,i)=>{
    const videoBtn=l.vid?`<button class="card-video-btn" onclick="event.stopPropagation();window.open('${esc(l.vid)}','_blank')">‚ñ∂Ô∏è Video</button>`:'';
    let imgTag='';
    if(l.img){
      const imgUrl=GITHUB_BASE+l.img;
      imgTag=`<div class="img-container">${videoBtn}<img src="${imgUrl}" alt="${esc(l.j)}"/></div>`;
    }else{
      imgTag=`<div class="report-icon">${l.e}</div>`;
    }
    return `<div class="report-card" onclick="window.open('${esc(l.u||'#')}','_blank')">
      ${imgTag}
      <h3>${esc(l.j)}</h3>
      <p>${esc(l.d)}</p>
      <div class="report-meta">
        <span class="report-date">${esc(l.t)}</span>
        <button class="report-btn" onclick="event.stopPropagation();window.open('${esc(l.u||'#')}','_blank')">${esc(l.b)}</button>
      </div>
    </div>`;
  }).join('');
}

function renderKegiatan(){
  const c=g('kegiatanStrip');
  if(!c)return;
  c.innerHTML=D.k.map((k,i)=>{
    const videoBtn=k.vid?`<button class="card-video-btn" onclick="event.stopPropagation();window.open('${esc(k.vid)}','_blank')">‚ñ∂Ô∏è Video</button>`:'';
    if(k.img){
      const imgUrl=GITHUB_BASE+k.img;
      return `<div class="kegiatan-card" onclick="openKegiatanLB(${i})">
        <div class="img-container">${videoBtn}<img src="${imgUrl}" alt="${esc(k.j)}"/></div>
        <div class="kegiatan-info"><h4>${esc(k.j)}</h4><span>${esc(k.t)}</span></div>
      </div>`;
    }else{
      return `<div class="kegiatan-card" onclick="openKegiatanLB(${i})">
        ${videoBtn}
        <div class="kegiatan-img">${k.e}</div>
        <div class="kegiatan-info"><h4>${esc(k.j)}</h4><span>${esc(k.t)}</span></div>
      </div>`;
    }
  }).join('');
}

function renderHero(){
  const heroImg=GITHUB_BASE+'hero.jpg';
  g('heroImage').innerHTML=`<img src="${heroImg}" alt="Hero Kalurahan Kedungsari" onerror="this.style.display='none'"/>`;
}

/* ADMIN LIST RENDER */
function renderFotoList(){
  const c=g('fotoList');
  if(!c)return;
  c.innerHTML=D.foto.map((f,i)=>`<div class="ap-list-item">
    <span style="font-size:1.3rem;flex-shrink:0">${f.e}</span>
    <div class="ap-list-body"><strong>${esc(f.j)}</strong><span>${esc(f.d)}</span></div>
    <div class="ap-list-actions">
      <button class="ap-edit" onclick="editFoto(${i})">Edit</button>
      <button class="ap-del" onclick="delFoto(${i})">Hapus</button>
    </div>
  </div>`).join('');
}

function renderLList(){
  const c=g('lList');
  if(!c)return;
  c.innerHTML=D.l.map((l,i)=>`<div class="ap-list-item">
    <span style="font-size:1.3rem;flex-shrink:0">${l.e}</span>
    <div class="ap-list-body"><strong>${esc(l.j)}</strong><span>${esc(l.d)}</span></div>
    <div class="ap-list-actions">
      <button class="ap-edit" onclick="editL(${i})">Edit</button>
      <button class="ap-del" onclick="delL(${i})">Hapus</button>
    </div>
  </div>`).join('');
}

function renderKList(){
  const c=g('kList');
  if(!c)return;
  c.innerHTML=D.k.map((k,i)=>`<div class="ap-list-item">
    <span style="font-size:1.3rem;flex-shrink:0">${k.e}</span>
    <div class="ap-list-body"><strong>${esc(k.j)}</strong><span>${esc(k.t)}</span></div>
    <div class="ap-list-actions">
      <button class="ap-edit" onclick="editK(${i})">Edit</button>
      <button class="ap-del" onclick="delK(${i})">Hapus</button>
    </div>
  </div>`).join('');
}

/* SAVE STATISTIK */
function saveStat(){
  const flds=['p','kk','ds','thn','d1','d1s','d2','d2s','d3','d3s','d4','d4s','d5','d5s','d6','d6s','tk1','tk2','tk3','tk4','tk5','tk6'];
  flds.forEach(k=>{const e=g('f_'+k);if(e&&e.value.trim())D.s[k]=e.value.trim();});
  store(D);renderStat();showToast('‚úÖ Statistik berhasil disimpan');
}

/* FOTO */
function addFoto(){
  g('fotoIdx').value=-1;
  g('fotoE').value='üèûÔ∏è';
  g('fotoJ').value='';
  g('fotoD').value='';
  g('fotoImg').value='';
  g('fotoVid').value='';
  g('fotoLbl').textContent='Tambah Foto';
  g('fotoForm').classList.add('active');
  scrollToForm('fotoForm');
}
function editFoto(i){
  const f=D.foto[i];
  g('fotoIdx').value=i;
  g('fotoE').value=f.e;
  g('fotoJ').value=f.j;
  g('fotoD').value=f.d;
  g('fotoImg').value=f.img||'';
  g('fotoVid').value=f.vid||'';
  g('fotoLbl').textContent='Edit Foto';
  g('fotoForm').classList.add('active');
  scrollToForm('fotoForm');
}
function saveFoto(){
  const o={
    e:g('fotoE').value||'üèûÔ∏è',
    j:g('fotoJ').value,
    d:g('fotoD').value,
    img:g('fotoImg').value||'',
    vid:g('fotoVid').value||''
  };
  if(!o.j){alert('Judul tidak boleh kosong');return;}
  const idx=parseInt(g('fotoIdx').value);
  if(idx===-1)D.foto.push(o);else D.foto[idx]=o;
  store(D);
  renderFoto();
  renderFotoList();
  g('fotoForm').classList.remove('active');
  showToast('‚úÖ Foto berhasil disimpan');
}
function delFoto(i){
  if(!confirm('Hapus foto ini?'))return;
  D.foto.splice(i,1);
  store(D);
  renderFoto();
  renderFotoList();
  showToast('üóëÔ∏è Foto berhasil dihapus');
}
function cancelFoto(){g('fotoForm').classList.remove('active');}

/* LAPORAN */
function addL(){
  g('lIdx').value=-1;
  g('lE').value='üìÑ';
  g('lJ').value='';
  g('lD').value='';
  g('lT').value='';
  g('lB').value='Unduh PDF';
  g('lU').value='';
  g('lImg').value='';
  g('lVid').value='';
  g('lLbl').textContent='Tambah Laporan';
  g('lForm').classList.add('active');
  scrollToForm('lForm');
}
function editL(i){
  const l=D.l[i];
  g('lIdx').value=i;
  g('lE').value=l.e;
  g('lJ').value=l.j;
  g('lD').value=l.d;
  g('lT').value=l.t;
  g('lB').value=l.b;
  g('lU').value=l.u||'';
  g('lImg').value=l.img||'';
  g('lVid').value=l.vid||'';
  g('lLbl').textContent='Edit Laporan';
  g('lForm').classList.add('active');
  scrollToForm('lForm');
}
function saveL(){
  const o={
    e:g('lE').value||'üìÑ',
    j:g('lJ').value,
    d:g('lD').value,
    t:g('lT').value,
    b:g('lB').value||'Lihat',
    u:g('lU').value,
    img:g('lImg').value||'',
    vid:g('lVid').value||''
  };
  if(!o.j){alert('Judul tidak boleh kosong');return;}
  const idx=parseInt(g('lIdx').value);
  if(idx===-1)D.l.push(o);else D.l[idx]=o;
  store(D);
  renderLaporan();
  renderLList();
  g('lForm').classList.remove('active');
  showToast('‚úÖ Laporan berhasil disimpan');
}
function delL(i){
  if(!confirm('Hapus laporan ini?'))return;
  D.l.splice(i,1);
  store(D);
  renderLaporan();
  renderLList();
  showToast('üóëÔ∏è Laporan berhasil dihapus');
}
function cancelL(){g('lForm').classList.remove('active');}

/* KEGIATAN */
function addK(){
  g('kIdx').value=-1;
  g('kE').value='üéâ';
  g('kJ').value='';
  g('kT').value='';
  g('kImg').value='';
  g('kVid').value='';
  g('kLbl').textContent='Tambah Kegiatan';
  g('kForm').classList.add('active');
  scrollToForm('kForm');
}
function editK(i){
  const k=D.k[i];
  g('kIdx').value=i;
  g('kE').value=k.e;
  g('kJ').value=k.j;
  g('kT').value=k.t;
  g('kImg').value=k.img||'';
  g('kVid').value=k.vid||'';
  g('kLbl').textContent='Edit Kegiatan';
  g('kForm').classList.add('active');
  scrollToForm('kForm');
}
function saveK(){
  const o={
    e:g('kE').value||'üéâ',
    j:g('kJ').value,
    t:g('kT').value,
    img:g('kImg').value||'',
    vid:g('kVid').value||''
  };
  if(!o.j){alert('Nama kegiatan tidak boleh kosong');return;}
  const idx=parseInt(g('kIdx').value);
  if(idx===-1)D.k.unshift(o);else D.k[idx]=o;
  store(D);
  renderKegiatan();
  renderKList();
  g('kForm').classList.remove('active');
  showToast('‚úÖ Kegiatan berhasil disimpan');
}
function delK(i){
  if(!confirm('Hapus kegiatan ini?'))return;
  D.k.splice(i,1);
  store(D);
  renderKegiatan();
  renderKList();
  showToast('üóëÔ∏è Kegiatan berhasil dihapus');
}
function cancelK(){g('kForm').classList.remove('active');}

/* PIN */
const PIN='1234';
let pinBuf='';
function openPIN(){pinBuf='';updDots();g('pinErr').textContent='';g('pinModal').classList.add('active');}
function closePIN(){g('pinModal').classList.remove('active');pinBuf='';}
function pk(v){
  if(v==='back'){pinBuf=pinBuf.slice(0,-1);updDots();return;}
  if(v==='clr'){pinBuf='';updDots();return;}
  if(pinBuf.length>=4)return;
  pinBuf+=v;updDots();
  if(pinBuf.length===4)setTimeout(checkPIN,160);
}
function updDots(){for(let i=0;i<4;i++)g('pd'+i).classList.toggle('filled',i<pinBuf.length);}
function checkPIN(){
  if(pinBuf===PIN){closePIN();openAdmin();}
  else{
    g('pinErr').textContent='‚ùå PIN salah, coba lagi';
    const b=document.querySelector('.pin-box');
    b.style.transition='none';b.style.transform='translateX(-8px)';
    setTimeout(()=>{b.style.transition='transform .1s';b.style.transform='translateX(8px)';},80);
    setTimeout(()=>{b.style.transform='translateX(0)';pinBuf='';updDots();},180);
  }
}

/* ADMIN PANEL */
function openAdmin(){
  const s=D.s;
  ['p','kk','ds','thn','d1','d1s','d2','d2s','d3','d3s','d4','d4s','d5','d5s','d6','d6s','tk1','tk2','tk3','tk4','tk5','tk6'].forEach(k=>{const e=g('f_'+k);if(e)e.value=s[k]||'';});
  renderFotoList();renderLList();renderKList();
  g('adminPanel').classList.add('open');
  g('adminBadge').classList.add('visible');
  document.body.style.overflow='hidden';
}
function closeAdmin(){g('adminPanel').classList.remove('open');document.body.style.overflow='';}
function adminLogout(){closeAdmin();g('adminBadge').classList.remove('visible');showToast('üëã Keluar dari mode admin');}
function swTab(name,btn){
  document.querySelectorAll('.ap-tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.ap-panel').forEach(p=>p.classList.remove('active'));
  btn.classList.add('active');g('tab-'+name).classList.add('active');
  document.querySelector('.ap-body').scrollTop=0;
}

/* HIDDEN TRIGGER */
let tc=0,tt=null;
function triggerHit(){
  tc++;clearTimeout(tt);tt=setTimeout(()=>tc=0,2500);
  if(tc>=5){tc=0;openPIN();}
}
g('adminTrigger').addEventListener('click',triggerHit);
g('adminTrigger').addEventListener('touchstart',function(e){e.preventDefault();triggerHit();},{passive:false});

/* LIGHTBOX */
function openFotoLB(e,ti,d){
  g('lbContent').innerHTML=`<div class="lightbox-emoji-big"><span>${e}</span></div>`;
  g('lbCaption').innerHTML=`<strong>${ti}</strong><br>${d}`;
  g('lightbox').classList.add('active');
  document.body.style.overflow='hidden';
}

function openPhotoLB(idx){
  const f=D.foto[idx];
  const imgUrl=GITHUB_BASE+f.img;
  g('lbContent').innerHTML=`<img src="${imgUrl}" alt="${esc(f.j)}"/>`;
  g('lbCaption').innerHTML=`<strong>${esc(f.j)}</strong><br>${esc(f.d)}`;
  g('lightbox').classList.add('active');
  document.body.style.overflow='hidden';
}

function openKegiatanLB(idx){
  const k=D.k[idx];
  if(k.img){
    const imgUrl=GITHUB_BASE+k.img;
    g('lbContent').innerHTML=`<img src="${imgUrl}" alt="${esc(k.j)}"/>`;
  }else{
    g('lbContent').innerHTML=`<div class="lightbox-emoji-big"><span>${k.e}</span></div>`;
  }
  g('lbCaption').innerHTML=`<strong>${esc(k.j)}</strong><br>${esc(k.t)}`;
  g('lightbox').classList.add('active');
  document.body.style.overflow='hidden';
}

function closeLB(ev){
  if(!ev||ev.target===g('lightbox')||(ev.currentTarget&&ev.currentTarget.classList.contains('lightbox-close'))){
    g('lightbox').classList.remove('active');
    document.body.style.overflow='';
  }
}

/* BACK TO TOP */
const btt=g('backToTop');
window.addEventListener('scroll',()=>btt.classList.toggle('show',scrollY>320));
btt.addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));

/* ESC KEY */
document.addEventListener('keydown',e=>{if(e.key==='Escape'){closeLB({target:g('lightbox')});closePIN();closeAdmin();}});

/* INIT */
renderAll();
</script>
</body>
</html>
